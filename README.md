## Описание проекта

UI тесты для cms Opencart на pytest + playwright.


+ В директории tests/ находятся файлы с тестами для отдельных страниц.

+ В директории pages/ находятся файлы с вспомогательными методами по каждой странице.
____

## Список необходимых предустановленных приложений и утилит

- Python3, Docker (для запуска opencart), Allure 
____

## Запуск приложения Opencart
(Должен быть всегда запущен для прогона тестов)

1. Запустить Docker
2. Приложение собирается из docker-compose.yml
Значение для OPENCART_HOST передается в командной строке через переменную local_ip - адрес вашей машины в сети
(узнать через ifconfig).
Выполнить команду:

```
local_ip=123.123.123.123 docker-compose up -d
```
После этого станут доступны: 
- приложение local_ip:80,
- админка local_i:8888,
- БД local_i:3306.


Подсказка - как применить сделанные в docker-compose.yml изменения:
```
docker-compose down 

Удалить все контейнеры:
docker rm -f $(docker ps -a -q)

Удалить все тома:
docker volume rm $(docker volume ls -q)

Перезапустить контейнеры:
docker-compose up -d

```

______

### Установка проекта и запуск тестов
- Скачать репозиторий на свою машину:

```
git clone repository_url
```

- Перейти в директорию скачанного репозитория

- Установить и активировать виртуальное окружение:

```
python3 -m venv venv
source venv/bin/activate
```
- Обновить PIP и установить зависимости:

```
pip install -U pip
pip install -r requirements.txt
```

- Выбрать интерпретатор для проекта (для запуска тестов через консоль/ide)

- Запустить Opencart

- Запустить выполнение тестов:

```
pytest --url=your_external_ip -n=2 --browser_name=firefox --devices='iPhone 12' --head tests/
```
где:
- -n (необязательно) - во сколько потоков запускать тесты, если не указывать параметр при запуске - тесты будут запущены в 1 поток.
- --url (обязательно) - адрес машины в сети (где запущен opencart)
- --browser-name (необязательно) - какой браузер запускать. Возможные значения: firefox, chromium, webkit. Если не указывать, то запуск в chromium
- --devices (необязательно) - какой девай сэмулировать (iPhone 12, iPhone 11, Pixel 2). Если не указан, то запуск без эмуляции девайса.
- --head (необязательно) - если указать, что браузер будет запущен в headed режиме, если не указать, то в режиме headless


- Получить Allure отчет:
В консоли выполнить команду, в качестве параметра указав путь до исполняемого файла allure на вашей машине:

```
./run_allure_report.sh /path/to/allure/bin
Пример: ./run_allure_report.sh /Applications/allure/bin/allure
```
